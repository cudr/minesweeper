(this["webpackJsonpcra-app-template"]=this["webpackJsonpcra-app-template"]||[]).push([[0],{14:function(e,t,r){},15:function(e,t,r){"use strict";r.r(t);var n,a,c,l=r(1),o=r(8),s=r.n(o),u=r(3),i=r(2),b=r(4);!function(e){e.INIT="init",e.IN_GAME="in-game",e.EXPLOSED="explosed",e.WIN="win"}(n||(n={})),function(e){e.START="start",e.RESTART="restart",e.DE_MINE="de_mine",e.MARK_MINE="mark_mine"}(a||(a={})),function(e){e[e.FLAG=11]="FLAG",e[e.EMPTY=0]="EMPTY",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.SIX=6]="SIX",e[e.SEVEN=7]="SEVEN",e[e.EIGHT=8]="EIGHT",e[e.MINE=9]="MINE",e[e.EXPLOSION=10]="EXPLOSION"}(c||(c={}));var j={state:n.INIT,marked:0,rows:0,columns:0,mines:0,cells:[],minesMap:null},O=function(e,t){return"".concat(e,"-").concat(t)},m=function(e){var t=e.split("-"),r=Object(i.a)(t,2),n=r[0],a=r[1];return[parseInt(n,10),parseInt(a,10)]},d=function(e,t){return Math.floor(Math.random()*(t-e))+e},p=function(e,t,r){var n=Object(i.a)(t,2),a=n[0],c=n[1],l=Object(b.a)(e),o=e[a],s=Object(b.a)(o);return s[c]=r,l[a]=s,l},E=function e(t,r,n){var a=Object(i.a)(r,2),l=a[0],o=a[1];if(l<0||l>=t.length||o<0||o>=t[0].length||t[l][o]>=c.EMPTY||n[O.apply(void 0,Object(b.a)(r))])return t;var s=function(e,t,r){for(var n=Object(i.a)(t,2),a=n[0],c=n[1],l=0,o=Math.max(0,a-1);o<=Math.min(e.length,a+1);o++)for(var s=Math.max(0,c-1);s<=Math.min(e[a].length,c+1);s++)r[O(o,s)]&&(l+=1);return l}(t,r,n);if(s>=c.MINE)return t;var u=p(t,r,s);return s!==c.EMPTY?u:[[l-1,o],[l+1,o],[l,o-1],[l,o+1]].reduce((function(t,r){return e(t,r,n)}),u)},f=function(e,t,r){var n=Object.keys(r).reduce((function(e,t){return p(e,m(t),c.MINE)}),e);return p(n,t,c.EXPLOSION)},I=function(e,t){var r,l;switch(t.type){case a.START:var o=t.payload,s=o.rows,p=o.columns;return Object(u.a)(Object(u.a)(Object(u.a)({},e),t.payload),{},{state:n.IN_GAME,cells:Array.from({length:s},(function(){return Array.from({length:p})}))});case a.RESTART:return j;case a.DE_MINE:if(e.state===n.EXPLOSED||e.state===n.WIN)return e;var I=parseInt(t.payload.row,10),v=parseInt(t.payload.cell,10),h=e.minesMap,M=[I,v];h||(h=function(e,t,r,n){for(var a={},c=r,l=O.apply(void 0,Object(b.a)(n));c;){var o=d(0,e),s=d(0,t),u=O(o,s);a[u]||u===l||(a[u]=!0,c-=1)}return a}(e.rows,e.columns,e.mines,M));var x=e.cells,y=h[O(I,v)];return(null===(r=x)||void 0===r||null===(l=r[I])||void 0===l?void 0:l[v])!==c.FLAG&&(x=(y?f:E)(e.cells,M,h)),Object(u.a)(Object(u.a)({},e),{},{cells:x,minesMap:h,state:y?n.EXPLOSED:e.state});case a.MARK_MINE:if(e.state===n.EXPLOSED||e.state===n.WIN)return e;var w,N=function(e,t){var r=Object(i.a)(t,2),n=r[0],a=r[1],l=e[n];if(l[a]>c.FLAG)return[e,0];var o,s=Object(b.a)(e),u=Object(b.a)(l);return u[a]===c.FLAG?(o=-1,delete u[a]):(u[a]=c.FLAG,o=1),s[n]=u,[s,o]}(e.cells,[parseInt(t.payload.row,10),parseInt(t.payload.cell,10)]),T=Object(i.a)(N,2),g=T[0],A=T[1],S=e.minesMap&&Object.keys(e.minesMap);return(null===S||void 0===S?void 0:S.length)&&(null===S||void 0===S?void 0:S.every((function(e){var t=m(e),r=Object(i.a)(t,2),n=r[0],a=r[1];return g[n][a]===c.FLAG})))&&(w=!0),Object(u.a)(Object(u.a)({},e),{},{state:w?n.WIN:e.state,marked:e.marked+A,cells:g});default:return e}},v=r(0),h=function(){var e=Object(l.useReducer)(I,j),t=Object(i.a)(e,2),r=t[0],c=t[1],o=r.state,s=r.rows,b=r.columns,O=r.cells,m=Object(l.useCallback)((function(e){e.target.dataset.cell&&c({type:a.DE_MINE,payload:Object(u.a)({},e.target.dataset)})}),[c]),d=Object(l.useCallback)((function(e){e.preventDefault(),e.target.dataset.cell&&c({type:a.MARK_MINE,payload:e.target.dataset})}),[c]),p=Object(l.useCallback)((function(e){e.preventDefault();var t=new FormData(e.target),r=parseInt(t.get("rows"),10),n=parseInt(t.get("columns"),10),l=parseInt(t.get("mines"),10);if(r*n<l+1)return alert("Mines count is too match!");for(var o=Array.from({length:n}),s=[],u=0;u<r;u++)s[u]=o;c({type:a.START,payload:{rows:r,columns:n,mines:l,cells:s}})}),[c]),E=Object(l.useCallback)((function(){c({type:a.RESTART,payload:null})}),[c]);return Object(l.useEffect)((function(){o===n.WIN&&alert("You win!"),o===n.EXPLOSED&&alert("BOOM!")}),[o]),o===n.INIT?Object(v.jsxs)("form",{onSubmit:p,children:[Object(v.jsx)("label",{htmlFor:"rows",children:"Rows:"}),Object(v.jsx)("input",{required:!0,max:"1000",type:"number",name:"rows",id:"rows"}),Object(v.jsx)("br",{}),Object(v.jsx)("label",{htmlFor:"columns",children:"Columns:"}),Object(v.jsx)("input",{required:!0,max:"1000",type:"number",name:"columns",id:"columns"}),Object(v.jsx)("br",{}),Object(v.jsx)("label",{htmlFor:"mines",children:"Mines:"}),Object(v.jsx)("input",{required:!0,max:"1000",type:"number",name:"mines",id:"mines"}),Object(v.jsx)("br",{}),Object(v.jsx)("button",{type:"submit",children:"Start Game!"})]}):Object(v.jsxs)(v.Fragment,{children:[Object(v.jsx)("button",{onClick:E,children:"Restart Game!"}),Object(v.jsx)("table",{onClick:m,onContextMenu:d,children:Object(v.jsx)(M,{rows:s,columns:b,cells:O})})]})},M=function(e){for(var t=e.rows,r=e.columns,n=e.cells,a=[],c=0;c<t;c++)a.push(Object(v.jsx)(y,{columns:r,rowIndex:c,rowData:n[c]},"row-".concat(c)));return Object(v.jsx)("tbody",{children:a})},x=function(e){for(var t=e.columns,r=e.rowIndex,n=e.rowData,a=[],c=0;c<t;c++)a.push(Object(v.jsx)(T,{state:n[c],rowIndex:r,idx:c},"cell-".concat(r,"-").concat(c)));return Object(v.jsx)("tr",{children:a})},y=Object(l.memo)(x);var w=["red","blue","green","red","purple","black","gray","maroon","turquoise"],N=function(e){var t=e.state,r=e.idx,n=e.rowIndex,a=function(e){return e===c.EMPTY?null:e===c.MINE?"\ud83d\udca3":e===c.FLAG?"\ud83d\udea9":e===c.EXPLOSION?"\ud83d\udca5":e||null}(t);return Object(v.jsx)("td",{style:{color:w[t],backgroundColor:t>=c.EMPTY&&t<c.FLAG?"white":"lightgray"},"data-row":n,"data-cell":r,children:a})},T=Object(l.memo)(N);r(14);s.a.render(Object(v.jsx)(h,{}),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.418e9f0b.chunk.js.map