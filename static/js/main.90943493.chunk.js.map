{"version":3,"sources":["modules/game.ts","App.tsx","index.tsx"],"names":["GameState","GameActionType","CellState","initialState","state","INIT","marked","rows","columns","mines","cells","minesMap","toKey","y","x","fromKey","key","split","parseInt","getRandomInt","min","max","Math","floor","random","updateCell","value","newState","rowData","newRow","openCell","point","length","EMPTY","count","counter","i","n","countMinesAtPoint","MINE","newCells","reduce","acc","el","finishGame","Object","keys","EXPLOSION","reducer","action","type","START","payload","IN_GAME","Array","from","RESTART","DE_MINE","EXPLOSED","WIN","row","cell","height","width","clickKey","col","generateMinesMap","isExlosed","FLAG","MARK_MINE","isWin","increment","markMine","every","mineKey","App","useReducer","gameState","dispatch","onClick","useCallback","e","target","dataset","onContextMenu","preventDefault","onSubmit","data","FormData","get","alert","onRestartGame","useEffect","htmlFor","required","name","id","Field","rowList","push","MemoRow","rowIndex","Row","cellList","MemoCell","idx","memo","cellColor","Cell","cellState","getState","style","color","backgroundColor","data-row","data-cell","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.90943493.chunk.js","sourcesContent":["import { useReducer } from 'react'\n\n/**\n * TYPES\n */\n\nexport enum GameState {\n  INIT = 'init',\n  IN_GAME = 'in-game',\n  EXPLOSED = 'explosed',\n  WIN = 'win'\n}\n\nexport enum GameActionType {\n  START = 'start',\n  RESTART = 'restart',\n  DE_MINE = 'de_mine',\n  MARK_MINE = 'mark_mine'\n}\n\nexport enum CellState {\n  FLAG = 11,\n  EMPTY = 0,\n  ONE = 1,\n  TWO = 2,\n  THREE = 3,\n  FOUR = 4,\n  FIVE = 5,\n  SIX = 6,\n  SEVEN = 7,\n  EIGHT = 8,\n  MINE = 9,\n  EXPLOSION = 10\n}\n\nexport type Point = [number, number]\nexport type CellStorage = number[][]\nexport type MinesMap = {\n  [key: string]: boolean\n}\n\nexport interface Game {\n  state: GameState\n  marked: number\n  rows: number\n  columns: number\n  mines: number\n  cells: CellStorage\n  minesMap: MinesMap | null\n}\n\nexport interface GameAction<T> {\n  type: GameActionType\n  payload: T\n}\n\n/**\n * CONSTANTS\n */\n\nconst initialState: Game = {\n  state: GameState.INIT,\n  marked: 0,\n  rows: 0,\n  columns: 0,\n  mines: 0,\n  cells: [],\n  minesMap: null\n}\n\n/**\n * HELPERS\n */\n\nexport const toKey = (y: string | number, x: string | number) => `${y}-${x}`\n\nexport const fromKey = (key: string): Point => {\n  const [y, x] = key.split('-')\n\n  return [parseInt(y, 10), parseInt(x, 10)]\n}\n\nconst getRandomInt = (min: number, max: number) =>\n  Math.floor(Math.random() * (max - min)) + min\n\nexport const generateMinesMap = (\n  height: number,\n  width: number,\n  mines: number,\n  point: Point\n) => {\n  const minesMap: MinesMap = {}\n\n  let count = mines\n\n  const clickKey = toKey(...point)\n\n  while (count) {\n    let row = getRandomInt(0, height)\n    let col = getRandomInt(0, width)\n\n    const key = toKey(row, col)\n\n    if (!minesMap[key] && key !== clickKey) {\n      minesMap[key] = true\n\n      count -= 1\n    }\n  }\n\n  return minesMap\n}\n\nexport const updateCell = (\n  state: CellStorage,\n  [y, x]: Point,\n  value: CellState\n) => {\n  const newState = [...state]\n  const rowData = state[y]\n  const newRow = [...rowData]\n  newRow[x] = value\n  newState[y] = newRow\n\n  return newState\n}\n\nexport const markMine = (\n  state: CellStorage,\n  point: Point\n): [CellStorage, number] => {\n  const [y, x] = point\n\n  const rowData = state[y]\n\n  if (rowData[x] > CellState.FLAG) return [state, 0]\n\n  const newState = [...state]\n  const newRow = [...rowData]\n  let increment\n\n  if (newRow[x] === CellState.FLAG) {\n    increment = -1\n    delete newRow[x]\n  } else {\n    newRow[x] = CellState.FLAG\n    increment = 1\n  }\n\n  newState[y] = newRow\n\n  return [newState, increment]\n}\n\nexport const countMinesAtPoint = (\n  state: CellStorage,\n  [y, x]: Point,\n  minesMap: MinesMap\n) => {\n  let counter = 0\n\n  for (let i = Math.max(0, y - 1); i <= Math.min(state.length, y + 1); i++) {\n    for (\n      let n = Math.max(0, x - 1);\n      n <= Math.min(state[y].length, x + 1);\n      n++\n    ) {\n      const key = toKey(i, n)\n      if (minesMap[key]) {\n        counter += 1\n      }\n    }\n  }\n\n  return counter\n}\n\nexport const openCell = (\n  state: CellStorage,\n  point: Point,\n  minesMap: MinesMap\n): CellStorage => {\n  const [y, x] = point\n\n  if (\n    y < 0 ||\n    y >= state.length ||\n    x < 0 ||\n    x >= state[0].length ||\n    state[y][x] >= CellState.EMPTY ||\n    minesMap[toKey(...point)]\n  )\n    return state\n\n  const count = countMinesAtPoint(state, point, minesMap)\n\n  if (count >= CellState.MINE) return state\n\n  const newCells = updateCell(state, point, count)\n\n  if (count !== CellState.EMPTY) return newCells\n\n  const points: Point[] = [\n    [y - 1, x],\n    [y + 1, x],\n    [y, x - 1],\n    [y, x + 1]\n  ]\n\n  return points.reduce((acc, el) => openCell(acc, el, minesMap), newCells)\n}\n\nconst finishGame = (state: CellStorage, point: Point, minesMap: MinesMap) => {\n  const newState = Object.keys(minesMap).reduce(\n    (acc, key) => updateCell(acc, fromKey(key), CellState.MINE),\n    state\n  )\n\n  return updateCell(newState, point, CellState.EXPLOSION)\n}\n\n/**\n * REDUCER\n */\n\nexport const reducer = (state: Game, action: GameAction<any>) => {\n  switch (action.type) {\n    case GameActionType.START:\n      const { rows, columns } = action.payload\n      return {\n        ...state,\n        ...action.payload,\n        state: GameState.IN_GAME,\n        cells: Array.from({ length: rows }, () =>\n          Array.from({ length: columns })\n        )\n      }\n    case GameActionType.RESTART:\n      return initialState\n    case GameActionType.DE_MINE:\n      if (state.state === GameState.EXPLOSED || state.state === GameState.WIN)\n        return state\n\n      const row = parseInt(action.payload.row, 10)\n      const cell = parseInt(action.payload.cell, 10)\n\n      let minesMap = state.minesMap,\n        point: Point = [row, cell]\n\n      if (!minesMap) {\n        minesMap = generateMinesMap(\n          state.rows,\n          state.columns,\n          state.mines,\n          point\n        )\n      }\n\n      let cells = state.cells,\n        isExlosed = minesMap[toKey(row, cell)]\n\n      if (cells?.[row]?.[cell] !== CellState.FLAG) {\n        cells = (isExlosed ? finishGame : openCell)(\n          state.cells,\n          point,\n          minesMap\n        )\n      }\n\n      return {\n        ...state,\n        cells,\n        minesMap,\n        state: isExlosed ? GameState.EXPLOSED : state.state\n      }\n    case GameActionType.MARK_MINE:\n      if (state.state === GameState.EXPLOSED || state.state === GameState.WIN)\n        return state\n\n      const [newCells, increment] = markMine(state.cells, [\n        parseInt(action.payload.row, 10),\n        parseInt(action.payload.cell, 10)\n      ])\n\n      const keys = state.minesMap && Object.keys(state.minesMap)\n\n      let isWin\n\n      if (\n        keys?.length &&\n        keys?.every(mineKey => {\n          const [y, x] = fromKey(mineKey)\n\n          return newCells[y][x] === CellState.FLAG\n        })\n      ) {\n        isWin = true\n      }\n\n      return {\n        ...state,\n        state: isWin ? GameState.WIN : state.state,\n        marked: state.marked + increment,\n        cells: newCells\n      }\n    default:\n      return state\n  }\n}\n\nexport const useGameReducer = () => useReducer(reducer, initialState)\n","import React, { useCallback, useEffect, memo } from 'react'\n\nimport {\n  useGameReducer,\n  Game,\n  GameState,\n  GameActionType,\n  CellStorage,\n  CellState\n} from './modules/game'\n\nconst App = () => {\n  const [gameState, dispatch] = useGameReducer()\n\n  const { state, rows, columns, cells } = gameState\n\n  const onClick = useCallback(\n    e => {\n      if (!e.target.dataset.cell) return\n\n      dispatch({\n        type: GameActionType.DE_MINE,\n        payload: { ...e.target.dataset }\n      })\n    },\n    [dispatch]\n  )\n\n  const onContextMenu = useCallback(\n    e => {\n      e.preventDefault()\n\n      if (!e.target.dataset.cell) return\n\n      dispatch({\n        type: GameActionType.MARK_MINE,\n        payload: e.target.dataset\n      })\n    },\n    [dispatch]\n  )\n\n  const onSubmit = useCallback(\n    e => {\n      e.preventDefault()\n\n      const data = new FormData(e.target as HTMLFormElement)\n\n      const rows = parseInt(data.get('rows') as string, 10)\n      const columns = parseInt(data.get('columns') as string, 10)\n      const mines = parseInt(data.get('mines') as string, 10)\n\n      if (rows * columns < mines + 1) {\n        return alert('Mines count is too match!')\n      }\n\n      const row: any[] = Array.from({ length: columns })\n\n      const cells: CellStorage = []\n\n      for (let i = 0; i < rows; i++) {\n        cells[i] = row\n      }\n\n      dispatch({\n        type: GameActionType.START,\n        payload: {\n          rows,\n          columns,\n          mines,\n          cells\n        }\n      })\n    },\n    [dispatch]\n  )\n\n  const onRestartGame = useCallback(() => {\n    dispatch({\n      type: GameActionType.RESTART,\n      payload: null\n    })\n  }, [dispatch])\n\n  useEffect(() => {\n    if (state === GameState.WIN) alert('You win!')\n    if (state === GameState.EXPLOSED) alert('BOOM!')\n  }, [state])\n\n  if (state === GameState.INIT) {\n    return (\n      <form onSubmit={onSubmit}>\n        <label htmlFor=\"rows\">Rows:</label>\n        <input required max=\"1000\" type=\"number\" name=\"rows\" id=\"rows\" />\n        <br />\n        <label htmlFor=\"columns\">Columns:</label>\n        <input required max=\"1000\" type=\"number\" name=\"columns\" id=\"columns\" />\n        <br />\n        <label htmlFor=\"mines\">Mines:</label>\n        <input required max=\"1000\" type=\"number\" name=\"mines\" id=\"mines\" />\n        <br />\n        <button type=\"submit\">Start Game!</button>\n      </form>\n    )\n  }\n\n  return (\n    <>\n      <button onClick={onRestartGame}>Restart Game!</button>\n      <table onClick={onClick} onContextMenu={onContextMenu}>\n        <Field rows={rows} columns={columns} cells={cells} />\n      </table>\n    </>\n  )\n}\n\nexport default App\n\nconst Field: React.FC<Pick<Game, 'rows' | 'columns' | 'cells'>> = ({\n  rows,\n  columns,\n  cells\n}) => {\n  let rowList = []\n\n  for (let i = 0; i < rows; i++) {\n    rowList.push(\n      <MemoRow\n        columns={columns}\n        key={`row-${i}`}\n        rowIndex={i}\n        rowData={cells[i]}\n      />\n    )\n  }\n\n  return <tbody>{rowList}</tbody>\n}\n\nconst Row: React.FC<{ columns: number; rowIndex: number; rowData: any[] }> = ({\n  columns,\n  rowIndex,\n  rowData\n}) => {\n  let cellList = []\n\n  for (let i = 0; i < columns; i++) {\n    cellList.push(\n      <MemoCell\n        state={rowData[i]}\n        rowIndex={rowIndex}\n        key={`cell-${rowIndex}-${i}`}\n        idx={i}\n      />\n    )\n  }\n\n  return <tr>{cellList}</tr>\n}\n\nconst MemoRow = memo(Row)\n\nfunction getState(state: number) {\n  if (state === CellState.EMPTY) return null\n  if (state === CellState.MINE) return '💣'\n  if (state === CellState.FLAG) return '🚩'\n  if (state === CellState.EXPLOSION) return '💥'\n\n  return state || null\n}\n\nconst cellColor = [\n  'red',\n  'blue',\n  'green',\n  'red',\n  'purple',\n  'black',\n  'gray',\n  'maroon',\n  'turquoise'\n]\n\nconst Cell: React.FC<{ state: number; idx: number; rowIndex: number }> = ({\n  state,\n  idx,\n  rowIndex\n}) => {\n  const cellState = getState(state)\n\n  return (\n    <td\n      style={{\n        color: cellColor[state],\n        backgroundColor:\n          state >= CellState.EMPTY && state < CellState.FLAG\n            ? 'white'\n            : 'lightgray'\n      }}\n      data-row={rowIndex}\n      data-cell={idx}\n    >\n      {cellState}\n    </td>\n  )\n}\n\nconst MemoCell = memo(Cell)\n","import React from 'react'\nimport ReactDOM from 'react-dom'\n\nimport App from './App'\n\nimport './index.css'\n\nReactDOM.render(<App />, document.getElementById('root'))\n"],"sourceRoot":""}