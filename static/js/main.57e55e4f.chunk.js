(this["webpackJsonpcra-app-template"]=this["webpackJsonpcra-app-template"]||[]).push([[0],{15:function(e,t,a){},16:function(e,t,a){"use strict";a.r(t);var r,n,c,l=a(1),o=a(9),s=a.n(o),u=a(2),i=a(3),b=a(6),j=a(4);!function(e){e.INIT="init",e.IN_GAME="in-game",e.EXPLOSED="explosed",e.WIN="win"}(r||(r={})),function(e){e.START="start",e.RESTART="restart",e.DE_MINE="de_mine",e.MARK_MINE="mark_mine"}(n||(n={})),function(e){e[e.FLAG=11]="FLAG",e[e.EMPTY=0]="EMPTY",e[e.ONE=1]="ONE",e[e.TWO=2]="TWO",e[e.THREE=3]="THREE",e[e.FOUR=4]="FOUR",e[e.FIVE=5]="FIVE",e[e.SIX=6]="SIX",e[e.SEVEN=7]="SEVEN",e[e.EIGHT=8]="EIGHT",e[e.MINE=9]="MINE",e[e.EXPLOSION=10]="EXPLOSION"}(c||(c={}));var O={state:r.INIT,marked:0,rows:0,columns:0,mines:0,cells:[],minesMap:null},m=function(e,t){return"".concat(e,"-").concat(t)},d=function(e){var t=e.split("-"),a=Object(i.a)(t,2),r=a[0],n=a[1];return[parseInt(r,10),parseInt(n,10)]},p=function(e,t){return Math.floor(Math.random()*(t-e))+e},E=function(e,t,a){var r=Object(i.a)(t,2),n=r[0],c=r[1],l=Object(j.a)(e),o=e[n],s=Object(j.a)(o);return s[c]=a,l[n]=s,l},f=function(e,t,a){for(var r=Object(i.a)(t,2),n=r[0],c=r[1],l=0,o=Math.max(0,n-1);o<=Math.min(e.length,n+1);o++)for(var s=Math.max(0,c-1);s<=Math.min(e[n].length,c+1);s++){a[m(o,s)]&&(l+=1)}return l},I=function(e,t,a){for(var r=Object(j.a)(e),n=Object(b.a)({},m.apply(void 0,Object(j.a)(t)),!0),l=[t],o=0;o<l.length;){var s=l[o],u=Object(i.a)(s,2),O=u[0],d=u[1];if(o++,!(O<0||O>=e.length||d<0||d>=e[0].length||e[O][d]>=c.EMPTY||a[m.apply(void 0,Object(j.a)(t))])){var p=f(r,s,a);if(!(p>=c.MINE))if(r=E(r,s,p),p===c.EMPTY)[[O-1,d],[O+1,d],[O,d-1],[O,d+1]].forEach((function(e){var t=m.apply(void 0,Object(j.a)(e));n[t]||(l.push(e),n[t]=!0)}))}}return r},v=function(e,t,a){var r=Object.keys(a).reduce((function(e,t){return E(e,d(t),c.MINE)}),e);return E(r,t,c.EXPLOSION)},h=function(e,t){var a,l;switch(t.type){case n.START:var o=t.payload,s=o.rows,b=o.columns;return Object(u.a)(Object(u.a)(Object(u.a)({},e),t.payload),{},{state:r.IN_GAME,cells:Array.from({length:s},(function(){return Array.from({length:b})}))});case n.RESTART:return O;case n.DE_MINE:if(e.state===r.EXPLOSED||e.state===r.WIN)return e;var E=parseInt(t.payload.row,10),f=parseInt(t.payload.cell,10),h=e.minesMap,M=[E,f];h||(h=function(e,t,a,r){for(var n={},c=a,l=m.apply(void 0,Object(j.a)(r));c;){var o=p(0,e),s=p(0,t),u=m(o,s);n[u]||u===l||(n[u]=!0,c-=1)}return n}(e.rows,e.columns,e.mines,M));var x=e.cells,y=h[m(E,f)];return(null===(a=x)||void 0===a||null===(l=a[E])||void 0===l?void 0:l[f])!==c.FLAG&&(x=(y?v:I)(e.cells,M,h)),Object(u.a)(Object(u.a)({},e),{},{cells:x,minesMap:h,state:y?r.EXPLOSED:e.state});case n.MARK_MINE:if(e.state===r.EXPLOSED||e.state===r.WIN)return e;var w,N=function(e,t){var a=Object(i.a)(t,2),r=a[0],n=a[1],l=e[r];if(l[n]>c.FLAG)return[e,0];var o,s=Object(j.a)(e),u=Object(j.a)(l);return u[n]===c.FLAG?(o=-1,delete u[n]):(u[n]=c.FLAG,o=1),s[r]=u,[s,o]}(e.cells,[parseInt(t.payload.row,10),parseInt(t.payload.cell,10)]),T=Object(i.a)(N,2),g=T[0],A=T[1],S=e.minesMap&&Object.keys(e.minesMap);return(null===S||void 0===S?void 0:S.length)&&(null===S||void 0===S?void 0:S.every((function(e){var t=d(e),a=Object(i.a)(t,2),r=a[0],n=a[1];return g[r][n]===c.FLAG})))&&(w=!0),Object(u.a)(Object(u.a)({},e),{},{state:w?r.WIN:e.state,marked:e.marked+A,cells:g});default:return e}},M=a(0),x=function(){var e=Object(l.useReducer)(h,O),t=Object(i.a)(e,2),a=t[0],c=t[1],o=a.state,s=a.rows,b=a.columns,j=a.cells,m=Object(l.useCallback)((function(e){e.target.dataset.cell&&c({type:n.DE_MINE,payload:Object(u.a)({},e.target.dataset)})}),[c]),d=Object(l.useCallback)((function(e){e.preventDefault(),e.target.dataset.cell&&c({type:n.MARK_MINE,payload:e.target.dataset})}),[c]),p=Object(l.useCallback)((function(e){e.preventDefault();var t=new FormData(e.target),a=parseInt(t.get("rows"),10),r=parseInt(t.get("columns"),10),l=parseInt(t.get("mines"),10);if(a*r<l+1)return alert("Mines count is too match!");for(var o=Array.from({length:r}),s=[],u=0;u<a;u++)s[u]=o;c({type:n.START,payload:{rows:a,columns:r,mines:l,cells:s}})}),[c]),E=Object(l.useCallback)((function(){c({type:n.RESTART,payload:null})}),[c]);return Object(l.useEffect)((function(){o===r.WIN&&alert("You win!"),o===r.EXPLOSED&&alert("BOOM!")}),[o]),o===r.INIT?Object(M.jsxs)("form",{onSubmit:p,children:[Object(M.jsx)("label",{htmlFor:"rows",children:"Rows:"}),Object(M.jsx)("input",{required:!0,max:"1000",type:"number",name:"rows",id:"rows"}),Object(M.jsx)("br",{}),Object(M.jsx)("label",{htmlFor:"columns",children:"Columns:"}),Object(M.jsx)("input",{required:!0,max:"1000",type:"number",name:"columns",id:"columns"}),Object(M.jsx)("br",{}),Object(M.jsx)("label",{htmlFor:"mines",children:"Mines:"}),Object(M.jsx)("input",{required:!0,max:"1000",type:"number",name:"mines",id:"mines"}),Object(M.jsx)("br",{}),Object(M.jsx)("button",{type:"submit",children:"Start Game!"})]}):Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)("button",{onClick:E,children:"Restart Game!"}),Object(M.jsx)("table",{onClick:m,onContextMenu:d,children:Object(M.jsx)(y,{rows:s,columns:b,cells:j})})]})},y=function(e){for(var t=e.rows,a=e.columns,r=e.cells,n=[],c=0;c<t;c++)n.push(Object(M.jsx)(N,{columns:a,rowIndex:c,rowData:r[c]},"row-".concat(c)));return Object(M.jsx)("tbody",{children:n})},w=function(e){for(var t=e.columns,a=e.rowIndex,r=e.rowData,n=[],c=0;c<t;c++)n.push(Object(M.jsx)(A,{state:r[c],rowIndex:a,idx:c},"cell-".concat(a,"-").concat(c)));return Object(M.jsx)("tr",{children:n})},N=Object(l.memo)(w);var T=["red","blue","green","red","purple","black","gray","maroon","turquoise"],g=function(e){var t=e.state,a=e.idx,r=e.rowIndex,n=function(e){return e===c.EMPTY?null:e===c.MINE?"\ud83d\udca3":e===c.FLAG?"\ud83d\udea9":e===c.EXPLOSION?"\ud83d\udca5":e||null}(t);return Object(M.jsx)("td",{style:{color:T[t],backgroundColor:t>=c.EMPTY&&t<c.FLAG?"white":"lightgray"},"data-row":r,"data-cell":a,children:n})},A=Object(l.memo)(g);a(15);s.a.render(Object(M.jsx)(x,{}),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.57e55e4f.chunk.js.map